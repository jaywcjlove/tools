{"version":3,"file":"static/js/6421.98d653a4.chunk.js","mappings":"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","sources":["../../packages/pdf-to-img/src/index.tsx"],"sourcesContent":["import { useState, useRef, useEffect } from 'react';\nimport { Wrapper, Spacing, StyledLayout, CopyButton, Button } from '@wcj/tools-react-components';\nimport * as PDF from 'pdfjs-dist';\nimport styled, { css } from 'styled-components';\n\n// @ts-ignore\nimport pdfjsWorker from 'pdfjs-dist/build/pdf.worker.entry';\nPDF.GlobalWorkerOptions.workerSrc = pdfjsWorker;\n\nexport interface ImageProps\n  extends React.DetailedHTMLProps<React.ImgHTMLAttributes<HTMLImageElement>, HTMLImageElement> {\n  ref?: React.LegacyRef<HTMLImageElement>;\n  error?: boolean;\n}\n\nconst InputPDF = styled.input``;\nconst Canvas = styled.canvas`\n  border: 1px solid var(--color-border-default);\n`;\n\nexport default function QRCodeGenerator() {\n  const canvas = useRef<HTMLCanvasElement>(null);\n  const [type, setType] = useState<'png' | 'jpg'>('png');\n  const [saveAll, setSaveAll] = useState<boolean>(false);\n  const [pdf, setPdf] = useState<PDF.PDFDocumentProxy>();\n  const [name, setName] = useState<string>();\n  const [pageNum, setPageNum] = useState<number>(1);\n  const [pageNumInfo, setPageNumInfo] = useState<string>();\n  const [loading, setLoading] = useState<boolean>();\n\n  useEffect(() => {\n    if (saveAll) {\n      renderPage(() => {\n        if (pageNum >= pdf!.numPages) {\n          setSaveAll(false);\n          return;\n        }\n        save();\n        setPageNum(pageNum + 1);\n        setSaveAll(true);\n      });\n    } else if (pdf && pageNum) {\n      renderPage();\n    }\n  }, [pdf, pageNum, saveAll]);\n\n  function renderPage(callback?: () => void) {\n    pdf?.getPage(pageNum).then((page) => {\n      let scale = 1.5;\n      let viewport = page.getViewport({ scale: scale });\n      canvas.current!.height = viewport.height;\n      canvas.current!.width = viewport.width;\n      canvas.current!.style.width = `${viewport.width}px`;\n      canvas.current!.style.height = `${viewport.height}px`;\n      const context = canvas.current!.getContext('2d');\n      let renderContext = {\n        canvasContext: context!,\n        viewport: viewport,\n      };\n      page.render(renderContext).promise.then(callback);\n    });\n    setPageNumInfo(`${pageNum} / ${pdf!.numPages}`);\n  }\n\n  function showPDF(url: string) {\n    let loadingTask = PDF.getDocument(url);\n    loadingTask.promise.then(\n      (doc) => {\n        setLoading(false);\n        setPdf(doc);\n        setPageNum(1);\n      },\n      (reason) => {\n        alert(reason);\n      },\n    );\n  }\n  const handleInput = (evn: React.ChangeEvent<HTMLInputElement>) => {\n    if (!evn.target.files) return;\n    const file = evn.target.files[0];\n    setLoading(true);\n    setPageNumInfo('');\n    setName(file.name);\n    let reader = new FileReader();\n    reader.onload = (e) => showPDF(e.target?.result as string);\n    reader.readAsDataURL(file);\n  };\n  function save() {\n    let a = document.createElement('a');\n    let event = new MouseEvent('click');\n    a.download = name + '-' + pageNum + '.' + type;\n    a.href = canvas.current!.toDataURL(type === 'png' ? 'image/png' : 'image/jpeg');\n    a.dispatchEvent(event);\n  }\n  const savePage = () => {\n    if (pageNum > pdf!.numPages) {\n      alert('All saved successfully');\n      return;\n    }\n    save();\n  };\n  function prevPage() {\n    if (pageNum <= 1) {\n      return;\n    }\n    setPageNum(pageNum - 1);\n  }\n\n  function nextPage() {\n    if (pageNum >= pdf!.numPages) {\n      return;\n    }\n    setPageNum(pageNum + 1);\n  }\n  return (\n    <Wrapper>\n      <StyledLayout title=\"Selected PDF File\" overflow=\"initial\">\n        <Spacing>\n          <InputPDF type=\"file\" accept=\"application/pdf\" onChange={handleInput} />\n          {pageNumInfo && (\n            <Spacing direction=\"row\">\n              <Button onClick={prevPage} disabled={pageNum === 1}>\n                Previous page\n              </Button>\n              <Button onClick={nextPage} disabled={!pdf || pageNum >= pdf.numPages}>\n                Next page\n              </Button>\n              <Button onClick={savePage}>Save this page</Button>\n              <Button\n                onClick={() => {\n                  setPageNum(1);\n                  setSaveAll(true);\n                }}\n              >\n                Save all\n              </Button>\n            </Spacing>\n          )}\n          {pageNumInfo && (\n            <div>\n              {name}, Page: {pageNumInfo}\n            </div>\n          )}\n          {loading === true && <div>Loading...</div>}\n          {loading === false && <Canvas ref={canvas} />}\n        </Spacing>\n      </StyledLayout>\n    </Wrapper>\n  );\n}\n"],"names":["PDF","pdfjsWorker","InputPDF","styled","Canvas","QRCodeGenerator","canvas","useRef","useState","type","saveAll","setSaveAll","pdf","setPdf","name","setName","pageNum","setPageNum","pageNumInfo","setPageNumInfo","loading","setLoading","renderPage","callback","getPage","then","page","viewport","getViewport","scale","current","height","width","style","renderContext","canvasContext","getContext","render","promise","numPages","useEffect","save","a","document","createElement","event","MouseEvent","download","href","toDataURL","dispatchEvent","_jsx","Wrapper","children","StyledLayout","title","overflow","_jsxs","Spacing","accept","onChange","evn","target","files","file","reader","FileReader","onload","e","url","_e$target","result","doc","reason","alert","readAsDataURL","direction","Button","onClick","disabled","ref"],"sourceRoot":""}